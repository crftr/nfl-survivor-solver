<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width" />

  <title>NFL Survivor Solver</title>

  <!-- UIkit CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.8.0/dist/css/uikit.min.css" />

  <!-- UIkit JS -->
  <script src="https://cdn.jsdelivr.net/npm/uikit@3.8.0/dist/js/uikit.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/uikit@3.8.0/dist/js/uikit-icons.min.js"></script>

  <style>
    section#nfl-teams ul,
    section#selected-team-section ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }

    section#selected-team-section ul {
      margin: 1rem 0;
    }

    li.selected {
      color: red;
    }
  </style>
</head>

<body>
  <div class="uk-container">

    <h1 class="uk-heading-divider">NFL Survivor Solver</h1>

    <div class="uk-grid">
      <div>
        <section id="nfl-teams">
          <h2 class="uk-heading-bullet">Teams</h2>
          <ul class="uk-list">
            <li data-name="Cardinals">Arizona Cardinals</li>
            <li data-name="Falcons">Atlanta Falcons</li>
            <li data-name="Ravens">Baltimore Ravens</li>
            <li data-name="Bills">Buffalo Bills</li>
            <li data-name="Panthers">Carolina Panthers</li>
            <li data-name="Bears">Chicago Bears</li>
            <li data-name="Bengals">Cincinnati Bengals</li>
            <li data-name="Browns">Cleveland Browns</li>
            <li data-name="Cowboys">Dallas Cowboys</li>
            <li data-name="Broncos">Denver Broncos</li>
            <li data-name="Lions">Detroit Lions</li>
            <li data-name="Packers">Green Bay Packers</li>
            <li data-name="Texans">Houston Texans</li>
            <li data-name="Colts">Indianapolis Colts</li>
            <li data-name="Jaguars">Jacksonville Jaguars</li>
            <li data-name="Chiefs">Kansas City Chiefs</li>
            <li data-name="Raiders">Las Vegas Raiders</li>
            <li data-name="Chargers">Los Angeles Chargers</li>
            <li data-name="Rams">Los Angeles Rams</li>
            <li data-name="Dolphins">Miami Dolphins</li>
            <li data-name="Vikings">Minnesota Vikings</li>
            <li data-name="Patriots">New England Patriots</li>
            <li data-name="Saints">New Orleans Saints</li>
            <li data-name="Giants">New York Giants</li>
            <li data-name="Jets">New York Jets</li>
            <li data-name="Eagles">Philadelphia Eagles</li>
            <li data-name="Steelers">Pittsburgh Steelers</li>
            <li data-name="48ers">San Francisco 49ers</li>
            <li data-name="Seahawks">Seattle Seahawks</li>
            <li data-name="Buccaneers">Tampa Bay Buccaneers</li>
            <li data-name="Titans">Tennessee Titans</li>
            <li data-name="Washington">Washington Football Team</li>
          </ul>
        </section>
      </div>

      <div>
        <section id="selected-team-section">
          <h2 class="uk-heading-bullet">Selected</h2>
          Start from
          <select id="starting-from-week">
            <option value="0">Week 1</option>
            <option value="1">Week 2</option>
            <option value="2">Week 3</option>
            <option value="3">Week 4</option>
            <option value="4">Week 5</option>
            <option value="5">Week 6</option>
            <option value="6">Week 7</option>
            <option value="7">Week 8</option>
            <option value="8">Week 9</option>
            <option value="9">Week 10</option>
            <option value="10">Week 11</option>
            <option value="11">Week 12</option>
            <option value="12">Week 13</option>
            <option value="13">Week 14</option>
            <option value="14">Week 15</option>
            <option value="15">Week 16</option>
            <option value="16">Week 17</option>
            <option value="17">Week 18</option>
          </select>

          <ul id="selected-teams" class="uk-list">
          </ul>

          <button type="button" id="undo" class="uk-button uk-button-default">
            Undo
          </button>

        </section>
      </div>
    </div>
  </div>




  <script>

    /* NFL Teams */

    const nflTeams = document.querySelectorAll("#nfl-teams li");
    for (const nflTeam of nflTeams) {
      nflTeam.addEventListener('click', function (event) {
        let teamName = event.target.getAttribute('data-name');
        if (teamMayBeSelected(teamName)) {
          addTeamToSelectedList(teamName);
          toggleTeamAsSelected(teamName);
        }
      })
    }

    function toggleTeamAsSelected(teamName) {
      const ul = document.getElementById("nfl-teams");
      const match = ul.querySelector(`[data-name="${teamName}"]`);
      match.classList.toggle('selected');
    }

    /* Selected Teams */

    function addTeamToSelectedList(teamName) {
      const ul = document.getElementById("selected-teams");
      const li = document.createElement("li");
      li.setAttribute("data-name", teamName);
      li.appendChild(document.createTextNode(`Week ${baseWeekNumber() + numberOfSelections()} ${teamName}`));
      ul.appendChild(li);
    }

    function baseWeekNumber() {
      return Number(document.querySelector("#starting-from-week").value);
    }

    function numberOfSelections() {
      const ul = document.getElementById("selected-teams");
      return ul.getElementsByTagName("li").length + 1;
    }

    function teamMayBeSelected(teamName) {
      const ul = document.getElementById("selected-teams");
      const match = ul.querySelector(`[data-name="${teamName}"]`);
      return !match;
    }

    function undoLastSelction() {
      const ul = document.getElementById("selected-teams");
      if (ul.lastChild) {
        const last = ul.removeChild(ul.lastChild);
        const teamName = last.getAttribute("data-name");
        toggleTeamAsSelected(teamName);
      }
    }

    function undoAll() {
      const ul = document.getElementById("selected-teams");
      while (ul.lastChild) {
        const last = ul.removeChild(ul.lastChild);
        const teamName = last.getAttribute("data-name");
        toggleTeamAsSelected(teamName);
      }
    }

    /* Week picker */

    const startWeekSelector = document.querySelector("select#starting-from-week");
    startWeekSelector.addEventListener('change', function (event) {
      undoAll();
    })

    /* Undo */

    const undoButton = document.querySelector("button#undo");
    undoButton.addEventListener('click', function (event) {
      undoLastSelction();
    })

  </script>

  <!-- <script src="worker.js"></script> -->
</body>

</html>